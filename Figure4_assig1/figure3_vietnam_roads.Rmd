---
title: "Figure 3-Vietnam roads"
output:
  pdf_document:
    latex_engine: xelatex
date: "2026-01-26"
---

## Introduction
This document replicates Figure 3 from Balboni (2021), *“In Harm’s Way? Infrastructure Investments and the Persistence of Coastal Cities”*.  

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE
)
```

## Packages
```{r}
library(sf)
library(dplyr)
library(ggplot2)
library(osmdata)
library(rnaturalearth)
library(patchwork)
```

## Vietnam Boundary
```{r}
vietnam <- ne_countries(
  scale = "medium",
  country = "Vietnam",
  returnclass = "sf"
)

st_crs(vietnam)
```

## Road Data
```{r, include=FALSE}
roads_ne <- ne_download(scale = "large",
                        type = "roads",
                        category = "cultural",
                        returnclass = "sf")

roads_ne
```

## Spatial Intersection
```{r, include=FALSE}
roads_vn <- st_intersection(roads_ne, vietnam)

roads_vn
```

## Road Type Classification
```{r}
table(roads_vn$featurecla)
table(roads_vn$type)
roads_vn <- roads_vn %>%
  mutate(road_cat = case_when(
    type == "Major Highway" ~ "Major roads",
    type == "Road" ~ "Minor roads",
    TRUE ~ "Other roads"
  ))

table(roads_vn$road_cat)
```

## Road Layers
```{r}
major_roads <- roads_vn %>% filter(road_cat == "Major roads")
minor_roads <- roads_vn %>% filter(road_cat == "Minor roads")
other_roads <- roads_vn %>% filter(road_cat == "Other roads")
```

## Replication of Figure 3

### Road Map 2000 (Approximation)
```{r}
map_2000 <- ggplot() +
  geom_sf(data = vietnam, fill = "white", color = "grey40") +
  geom_sf(data = minor_roads, color = "#f2c879", size = 0.2) +
  geom_sf(data = major_roads, color = "red", size = 0.6) +
  theme_minimal() +
  theme(
    panel.grid = element_blank(),
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank()
  ) +
  ggtitle("Road map 2000")
```

### Road Map 2010
```{r}
map_2010 <- ggplot() +
  geom_sf(data = vietnam, fill = "white", color = "grey40") +
  geom_sf(data = other_roads, aes(color = "Other roads"), size = 0.15) +
  geom_sf(data = minor_roads, aes(color = "Minor roads"), size = 0.3) +
  geom_sf(data = major_roads, aes(color = "Major roads"), size = 0.6) +
  scale_color_manual(
    name = "Road types",
    values = c(
      "Major roads" = "red",
      "Minor roads" = "#f1a340",
      "Other roads" = "#f7d7a6"
    )
  ) +
  theme_minimal() +
  theme(
    panel.grid = element_blank(),
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank()
  ) +
  ggtitle("Road map 2010")
```

## Final Figure
```{r}
(map_2000 | map_2010) +
  plot_layout(guides = "collect") & 
  theme(
    legend.position = "bottom",
    legend.justification = "center",
    legend.title = element_text(size = 11),
    legend.text = element_text(size = 10)
  )
```
**Figure 3.** Road infrastructure in Vietnam in 2000 (approximation) and 2010 by road type.


## Data Availability and Approximation

The original paper digitizes road categories from ITMB travel maps, which are not publicly available. Therefore, the original road network data used in the paper cannot be accessed or directly replicated.

As an initial attempt, OpenStreetMap road data were queried through the Overpass API in order to recover detailed road categories. However, even after restricting the query to major road classes and subdividing the spatial extent, the resulting datasets exceeded the available memory limits of the R session, producing repeated vector memory allocation errors. This made the direct use of OpenStreetMap data infeasible in the present computational environment.

Following the assignment instruction, this replication instead relies on the Natural Earth road dataset, which provides a harmonized global road network at medium and large scales. Roads are classified into major, minor, and other categories based on the `type` attribute.

Because historical road networks are unavailable, the 2000 network is approximated by retaining only major and minor roads, while the 2010 network includes all available road categories. This approach captures the main spatial structure of Vietnam’s road infrastructure while remaining computationally feasible and consistent with the assignment requirements.


